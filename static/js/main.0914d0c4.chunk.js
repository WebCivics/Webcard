(this["webpackJsonpwebcard-viewer"]=this["webpackJsonpwebcard-viewer"]||[]).push([[0],{137:function(e,t,s){},145:function(e,t){},147:function(e,t){},214:function(e,t){},255:function(e,t,s){"use strict";s.r(t);var n=s(0),r=s.n(n),a=s(7),c=s.n(a),l=(s(137),s(286)),o=s(287),i=s(121),d=s(3);const h={"https://webcivics.github.io/adp/ontdev/adp#hasLinkedinAccount":{name:"LinkedIn",baseUrl:"https://www.linkedin.com/in/",icon:Object(d.jsx)("svg",{className:"w-6 h-6 mr-3",fill:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:Object(d.jsx)("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})},"https://webcivics.github.io/adp/ontdev/adp#hasTwitterAccount":{name:"Twitter",baseUrl:"https://x.com/",icon:Object(d.jsx)("svg",{className:"w-6 h-6 mr-3",fill:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:Object(d.jsx)("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24h-6.617l-5.21-6.817-6.044 6.817h-3.308l7.73-8.805-7.993-10.69h6.77l4.61 6.245 5.46-6.245zm-1.161 17.52h1.839l-10.123-13.65h-1.990l10.274 13.65z"})})}},u=e=>{const[t,s]=Object(n.useState)(null),[r,a]=Object(n.useState)(!0),[c,i]=Object(n.useState)(null),d=Object(n.useCallback)(async()=>{if(e){a(!0),i(null),s(null);try{const t=await fetch(`https://cloudflare-dns.com/dns-query?name=_adp.${e}&type=TXT`,{headers:{accept:"application/dns-json"}});if(!t.ok)throw new Error(`DNS query failed with status: ${t.status}`);const n=await t.json();if(!n.Answer||0===n.Answer.length)throw new Error(`No ADP record found for ${e}.`);const r=n.Answer[0].data.replace(/"/g,"").match(/dnslink=\/ipfs\/(\S+)/);if(!r||!r[1])throw new Error("Could not find a valid IPFS CID in the DNS record.");const a=r[1],c=await fetch(`https://ipfs.io/ipfs/${a}`);if(!c.ok)throw new Error(`IPFS fetch failed with status: ${c.status}`);const i=await c.text(),d=await(e=>new Promise((t,s)=>{const n=new l.a;(new o.a).parse(e,(e,r,a)=>{if(e)return s(e);if(r)n.addQuad(r);else{const e={name:null,domain:null,ecash:null,properties:[]},r=n.getSubjects(null,null,null);if(0===r.length)return s(new Error("No subject found in RDF data."));const a=r[0];n.getQuads(a,null,null).forEach(t=>{const s=t.predicate.value,n=t.object.value;"http://xmlns.com/foaf/0.1/name"===s?e.name=n:"https://schema.org/domain"===s?e.domain=n:"https://webcivics.github.io/adp/ontdev/adp#hasEcashAccount"===s?e.ecash=n:h[s]&&e.properties.push({type:h[s].name,user:n,url:`${h[s].baseUrl}${n}`,icon:h[s].icon})}),t(e)}})}))(i);s(d)}catch(t){console.error("Error fetching ADP data:",t),i(t)}finally{a(!1)}}else a(!1)},[e]);return Object(n.useEffect)(()=>{d()},[d]),{profileData:t,loading:r,error:c}},b=()=>Object(d.jsx)("div",{className:"flex justify-center items-center p-10",children:Object(d.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-white"})}),m=e=>{let{message:t}=e;return Object(d.jsxs)("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-lg shadow-md",role:"alert",children:[Object(d.jsx)("p",{className:"font-bold",children:"Error"}),Object(d.jsx)("p",{children:t})]})},p=e=>{let{type:t,url:s,icon:n}=e;return Object(d.jsxs)("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"w-full bg-white/20 hover:bg-white/30 text-white font-bold py-3 px-4 rounded-lg shadow-lg flex items-center justify-center transition-all duration-300 ease-in-out transform hover:scale-105",children:[n||null,Object(d.jsx)("span",{children:t})]})},j=e=>{let{domain:t}=e;const{profileData:s,loading:n,error:r}=u(t);return n?Object(d.jsx)(b,{}):r?Object(d.jsx)(m,{message:r.message}):s?Object(d.jsxs)("div",{className:"w-full max-w-md mx-auto p-6 md:p-8 bg-black/20 backdrop-blur-xl rounded-2xl shadow-2xl text-white text-center",children:[Object(d.jsxs)("div",{className:"mb-6",children:[Object(d.jsx)("img",{src:`https://placehold.co/128x128/764ba2/ffffff?text=${s.name?s.name.charAt(0):"A"}`,alt:"Profile",className:"w-32 h-32 rounded-full mx-auto border-4 border-white/50 shadow-lg"}),Object(d.jsx)("h1",{className:"text-3xl font-bold mt-4",children:s.name||"Anonymous"}),Object(d.jsx)("p",{className:"text-gray-300",children:s.domain})]}),Object(d.jsx)("div",{className:"space-y-4 mb-6",children:s.properties.map(e=>Object(d.jsx)(p,{type:e.type,url:e.url,icon:e.icon},e.type))}),s.ecash&&Object(d.jsxs)("div",{className:"border-t border-white/20 pt-6",children:[Object(d.jsx)("h2",{className:"text-lg font-semibold mb-3",children:"Support Me"}),Object(d.jsx)("div",{className:"flex justify-center",children:Object(d.jsx)(i.a,{to:s.ecash,text:"Send a Tip"})})]})]}):Object(d.jsx)(m,{message:"Could not load profile data."})},x=e=>{let{domain:t}=e;const{profileData:s,loading:n,error:r}=u(t);if(n)return Object(d.jsx)("pre",{className:"text-white bg-black/20 p-4 rounded-lg",children:"Loading..."});if(r)return Object(d.jsx)("pre",{className:"text-white bg-black/20 p-4 rounded-lg",children:JSON.stringify({error:r.message},null,2)});const a={ecash:(null===s||void 0===s?void 0:s.ecash)||null};return Object(d.jsx)("pre",{className:"text-white bg-black/20 p-4 rounded-lg",children:JSON.stringify(a,null,2)})},f=e=>{let{onDomainSubmit:t}=e;const[s,r]=Object(n.useState)("");return Object(d.jsxs)("div",{className:"w-full max-w-md mx-auto p-8 bg-black/20 backdrop-blur-xl rounded-2xl shadow-2xl text-white text-center",children:[Object(d.jsx)("h1",{className:"text-4xl font-bold mb-4",children:"WebCard Viewer"}),Object(d.jsx)("p",{className:"text-lg mb-6",children:"Enter a domain to look up an Agent Discovery Profile."}),Object(d.jsxs)("form",{onSubmit:e=>{e.preventDefault(),s.trim()&&t(s.trim())},className:"flex flex-col sm:flex-row gap-2",children:[Object(d.jsx)("input",{type:"text",value:s,onChange:e=>r(e.target.value),placeholder:"example.com",className:"flex-grow px-4 py-2 rounded-lg bg-white/20 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-white/50"}),Object(d.jsx)("button",{type:"submit",className:"bg-white/30 hover:bg-white/40 text-white font-bold py-2 px-6 rounded-lg transition-colors",children:"Look Up"})]})]})};var w=function(){const[e,t]=Object(n.useState)(null),[s,r]=Object(n.useState)("profile");return Object(n.useEffect)(()=>{const e=window.location.pathname.replace(/^\/|\/$/g,"").split("/").filter(e=>e).pop(),s=new URLSearchParams(window.location.search);e&&e.includes(".")&&t(e),s.has("ecash")?r("ecash"):r("profile")},[]),"ecash"===s?Object(d.jsx)("div",{className:"min-h-screen flex items-center justify-center p-4",children:Object(d.jsx)(x,{domain:e})}):Object(d.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center p-4",children:[e?Object(d.jsx)(j,{domain:e}):Object(d.jsx)(f,{onDomainSubmit:e=>{const s=`${window.location.pathname.replace(/[^/]*$/,"")}${e}`;window.history.pushState({},"",s),t(e)}}),Object(d.jsx)("footer",{className:"text-center text-white/70 mt-8 text-sm",children:Object(d.jsx)("p",{children:"Powered by WebCivics ADP"})})]})};var g=e=>{e&&e instanceof Function&&s.e(3).then(s.bind(null,288)).then(t=>{let{getCLS:s,getFID:n,getFCP:r,getLCP:a,getTTFB:c}=t;s(e),n(e),r(e),a(e),c(e)})};c.a.render(Object(d.jsx)(r.a.StrictMode,{children:Object(d.jsx)(w,{})}),document.getElementById("root")),g()}},[[255,1,2]]]);
//# sourceMappingURL=main.0914d0c4.chunk.js.map