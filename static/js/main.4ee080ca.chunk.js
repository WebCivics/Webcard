(this.webpackJsonpwebcard=this.webpackJsonpwebcard||[]).push([[0],{136:function(e,t,n){},137:function(e,t,n){},146:function(e,t){},148:function(e,t){},215:function(e,t){},255:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(7),s=n.n(o),c=(n(136),n(137),n(5));var l=function(e){let{onDomainSubmit:t}=e;const[n,r]=Object(a.useState)("");return Object(c.jsxs)("div",{className:"w-full max-w-md text-center",children:[Object(c.jsx)("h1",{className:"text-4xl font-bold mb-2",children:"WebCard Viewer"}),Object(c.jsx)("p",{className:"text-gray-400 mb-6",children:"Enter a domain to look up its Agent Discovery Protocol (ADP) record."}),Object(c.jsxs)("form",{onSubmit:e=>{e.preventDefault(),n&&t(n)},className:"flex flex-col sm:flex-row gap-2",children:[Object(c.jsx)("label",{htmlFor:"domain-input",className:"sr-only",children:"Domain Name"}),Object(c.jsx)("input",{id:"domain-input",type:"text",value:n,onChange:e=>r(e.target.value),placeholder:"sailingdigital.com",className:"flex-grow bg-gray-800 border border-gray-700 rounded-md px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),Object(c.jsx)("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-md transition-colors",children:"Look Up"})]})]})},i=n(79),d=n(120);var u=function(e){var t;let{domain:n}=e;const[r,o]=Object(a.useState)(null),[s,l]=Object(a.useState)(!0),[u,m]=Object(a.useState)(null),[h,b]=Object(a.useState)(!1);return Object(a.useEffect)(()=>{new URLSearchParams(window.location.search).has("ecash")&&b(!0);(async()=>{try{var e,t;l(!0),m(null);const a=await fetch(`https://cloudflare-dns.com/dns-query?name=_adp.${n}&type=TXT`,{headers:{accept:"application/dns-json"}});if(!a.ok)throw new Error("DNS query failed. Check the domain and network connection.");const r=null===(e=(await a.json()).Answer)||void 0===e||null===(t=e.find(e=>16===e.type))||void 0===t?void 0:t.data.replace(/"/g,"");if(!r)throw new Error(`No ADP TXT record found for ${n}.`);const s=r.match(/ipfs=([a-zA-Z0-9]+)/);if(!s||!s[1])throw new Error("Could not find a valid IPFS CID in the TXT record.");const c=s[1],d=await fetch(`https://ipfs.io/ipfs/${c}`);if(!d.ok)throw new Error("Failed to fetch data from IPFS gateway.");const u=await d.text(),h=new i.a.Parser,b=[];await new Promise((e,t)=>{h.parse(u,(n,a,r)=>{if(n)return t(new Error(`RDF Parsing Error: ${n.message}`));if(a)b.push(a);else{var s,c,l;const t=new i.a.Store(b),n="http://xmlns.com/foaf/0.1/",a="https://webcivics.github.io/adp/ontdev/adp#",r={hasTwitterAccount:{name:"Twitter",url:"https://twitter.com/"},hasLinkedinAccount:{name:"LinkedIn",url:"https://www.linkedin.com/in/"},hasGithubAccount:{name:"GitHub",url:"https://github.com/"}},d=null===(s=t.getObjects(null,`${n}name`,null)[0])||void 0===s?void 0:s.value,u=null===(c=t.getObjects(null,`${n}img`,null)[0])||void 0===c?void 0:c.id,m=null===(l=t.getObjects(null,`${a}hasEcashAccount`,null)[0])||void 0===l?void 0:l.value,h=[];for(const e in r){const n=t.getObjects(null,`${a}${e}`,null)[0];n&&h.push({name:r[e].name,url:`${r[e].url}${n.value}`})}const f=t.getObjects(null,`${n}page`,null).map(e=>({name:(()=>{try{return new URL(e.id).hostname}catch{return e.id}})(),url:e.id}));o({name:d,img:u,eCashAddress:m,links:[...h,...f]}),e()}})})}catch(a){m(a.message)}finally{l(!1)}})()},[n]),s?Object(c.jsxs)("div",{className:"text-center",children:[Object(c.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4"}),Object(c.jsxs)("p",{children:["Fetching profile for ",Object(c.jsx)("span",{className:"font-bold",children:n}),"..."]})]}):u?Object(c.jsxs)("div",{className:"bg-red-900 border border-red-500 text-red-200 px-4 py-3 rounded-md w-full max-w-lg text-center",children:[Object(c.jsx)("h2",{className:"font-bold text-lg mb-2",children:"Error"}),Object(c.jsx)("p",{children:u}),Object(c.jsx)("a",{href:"/",className:"inline-block bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-md mt-4 transition-colors",children:"Try Again"})]}):r?h?Object(c.jsx)("pre",{className:"bg-gray-800 p-4 rounded-md w-full max-w-lg whitespace-pre-wrap break-all text-left",children:JSON.stringify({eCashAddress:r.eCashAddress||null},null,2)}):Object(c.jsxs)("div",{className:"bg-gray-800 shadow-lg rounded-lg p-6 w-full max-w-md text-center animate-fade-in",children:[r.img&&Object(c.jsx)("img",{src:r.img,alt:r.name,className:"w-24 h-24 rounded-full mx-auto mb-4 border-4 border-gray-700 object-cover"}),Object(c.jsx)("h1",{className:"text-2xl font-bold",children:r.name||"No Name Found"}),Object(c.jsx)("div",{className:"mt-6 w-full flex flex-col gap-4",children:null===(t=r.links)||void 0===t?void 0:t.map((e,t)=>Object(c.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"bg-gray-700 hover:bg-gray-600 text-white font-semibold py-3 px-4 rounded-md transition-colors w-full",children:e.name},t))}),r.eCashAddress&&Object(c.jsx)("div",{className:"mt-6",children:Object(c.jsx)(d.a,{to:r.eCashAddress,text:"Tip with eCash",theme:{colors:{primary:"#0ea5e9",secondary:"#334155",tertiary:"white"}}})})]}):Object(c.jsx)("div",{className:"text-center",children:Object(c.jsx)("p",{children:"Could not load profile data."})})};var m=function(){const[e,t]=Object(a.useState)("");return Object(a.useEffect)(()=>{const e=new URLSearchParams(window.location.search).get("domain");e&&t(e)},[]),Object(c.jsxs)("div",{className:"bg-gray-900 min-h-screen flex flex-col items-center justify-center text-white font-sans p-4",children:[e?Object(c.jsx)(u,{domain:e,onReset:()=>{const e=window.location.href.split("?")[0];window.location.href=e}}):Object(c.jsx)(l,{onDomainSubmit:e=>{const t=`${window.location.href.split("?")[0]}?domain=${encodeURIComponent(e)}`;window.location.href=t}}),Object(c.jsx)("footer",{className:"absolute bottom-4 text-gray-500 text-sm",children:"Built with the assistance of an AI assistant."})]})};var h=e=>{e&&e instanceof Function&&n.e(3).then(n.bind(null,285)).then(t=>{let{getCLS:n,getFID:a,getFCP:r,getLCP:o,getTTFB:s}=t;n(e),a(e),r(e),o(e),s(e)})};s.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(m,{})}),document.getElementById("root")),h()}},[[255,1,2]]]);
//# sourceMappingURL=main.4ee080ca.chunk.js.map