(this.webpackJsonpwebcard=this.webpackJsonpwebcard||[]).push([[0],{136:function(e,t,n){},137:function(e,t,n){},146:function(e,t){},148:function(e,t){},215:function(e,t){},255:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(7),o=n.n(s),l=(n(136),n(137),n(5));var c=function(){const[e,t]=Object(a.useState)("");return Object(l.jsxs)("div",{className:"w-full max-w-md text-center",children:[Object(l.jsx)("h1",{className:"text-4xl font-bold mb-2",children:"WebCard Viewer"}),Object(l.jsx)("p",{className:"text-gray-400 mb-6",children:"Enter a domain to look up its Agent Discovery Protocol (ADP) record."}),Object(l.jsxs)("form",{onSubmit:t=>{t.preventDefault(),e&&(window.location.pathname=`/${encodeURIComponent(e)}`)},className:"flex flex-col sm:flex-row gap-2",children:[Object(l.jsx)("label",{htmlFor:"domain-input",className:"sr-only",children:"Domain Name"}),Object(l.jsx)("input",{id:"domain-input",type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"sailingdigital.com",className:"flex-grow bg-gray-800 border border-gray-700 rounded-md px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),Object(l.jsx)("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-md transition-colors",children:"Look Up"})]})]})},i=n(79),d=n(120);var u=function(e){var t;let{domain:n}=e;const[r,s]=Object(a.useState)(null),[o,c]=Object(a.useState)(!0),[u,m]=Object(a.useState)(null),[b,h]=Object(a.useState)(!1);return Object(a.useEffect)(()=>{new URLSearchParams(window.location.search).has("ecash")&&h(!0);(async()=>{try{var e,t;c(!0),m(null);const a=await fetch(`https://cloudflare-dns.com/dns-query?name=_adp.${n}&type=TXT`,{headers:{accept:"application/dns-json"}});if(!a.ok)throw new Error("DNS query failed. Check the domain and network connection.");const r=null===(e=(await a.json()).Answer)||void 0===e||null===(t=e.find(e=>16===e.type))||void 0===t?void 0:t.data.replace(/"/g,"");if(!r)throw new Error(`No ADP TXT record found for ${n}.`);const o=r.match(/ipfs=([a-zA-Z0-9]+)/);if(!o||!o[1])throw new Error("Could not find a valid IPFS CID in the TXT record.");const l=o[1],d=await fetch(`https://ipfs.io/ipfs/${l}`);if(!d.ok)throw new Error("Failed to fetch data from IPFS gateway.");const u=await d.text(),b=new i.a.Parser,h=[];await new Promise((e,t)=>{b.parse(u,(n,a,r)=>{if(n)return t(new Error(`RDF Parsing Error: ${n.message}`));if(a)h.push(a);else{var o,l,c;const t=new i.a.Store(h),n="http://xmlns.com/foaf/0.1/",a="https://webcivics.github.io/adp/ontdev/adp#",r={hasTwitterAccount:{name:"Twitter",url:"https://twitter.com/"},hasLinkedinAccount:{name:"LinkedIn",url:"https://www.linkedin.com/in/"},hasGithubAccount:{name:"GitHub",url:"https://github.com/"}},d=null===(o=t.getObjects(null,`${n}name`,null)[0])||void 0===o?void 0:o.value,u=null===(l=t.getObjects(null,`${n}img`,null)[0])||void 0===l?void 0:l.id,m=null===(c=t.getObjects(null,`${a}hasEcashAccount`,null)[0])||void 0===c?void 0:c.value,b=[];for(const e in r){const n=t.getObjects(null,`${a}${e}`,null)[0];n&&b.push({name:r[e].name,url:`${r[e].url}${n.value}`})}const f=t.getObjects(null,`${n}page`,null).map(e=>({name:(()=>{try{return new URL(e.id).hostname}catch{return e.id}})(),url:e.id}));s({name:d,img:u,eCashAddress:m,links:[...b,...f]}),e()}})})}catch(a){m(a.message)}finally{c(!1)}})()},[n]),o?Object(l.jsxs)("div",{className:"text-center",children:[Object(l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4"}),Object(l.jsxs)("p",{children:["Fetching profile for ",Object(l.jsx)("span",{className:"font-bold",children:n}),"..."]})]}):u?Object(l.jsxs)("div",{className:"bg-red-900 border border-red-500 text-red-200 px-4 py-3 rounded-md w-full max-w-lg text-center",children:[Object(l.jsx)("h2",{className:"font-bold text-lg mb-2",children:"Error"}),Object(l.jsx)("p",{children:u}),Object(l.jsx)("a",{href:"/",className:"inline-block bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-md mt-4 transition-colors",children:"Try Again"})]}):r?b?Object(l.jsx)("pre",{className:"bg-gray-800 p-4 rounded-md w-full max-w-lg whitespace-pre-wrap break-all text-left",children:JSON.stringify({eCashAddress:r.eCashAddress||null},null,2)}):Object(l.jsxs)("div",{className:"bg-gray-800 shadow-lg rounded-lg p-6 w-full max-w-md text-center animate-fade-in",children:[r.img&&Object(l.jsx)("img",{src:r.img,alt:r.name,className:"w-24 h-24 rounded-full mx-auto mb-4 border-4 border-gray-700 object-cover"}),Object(l.jsx)("h1",{className:"text-2xl font-bold",children:r.name||"No Name Found"}),Object(l.jsx)("div",{className:"mt-6 w-full flex flex-col gap-4",children:null===(t=r.links)||void 0===t?void 0:t.map((e,t)=>Object(l.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"bg-gray-700 hover:bg-gray-600 text-white font-semibold py-3 px-4 rounded-md transition-colors w-full",children:e.name},t))}),r.eCashAddress&&Object(l.jsx)("div",{className:"mt-6",children:Object(l.jsx)(d.a,{to:r.eCashAddress,text:"Tip with eCash",theme:{colors:{primary:"#0ea5e9",secondary:"#334155",tertiary:"white"}}})})]}):Object(l.jsx)("div",{className:"text-center",children:Object(l.jsx)("p",{children:"Could not load profile data."})})};var m=function(){const[e,t]=Object(a.useState)("");return Object(a.useEffect)(()=>{const e=window.location.pathname.split("/").filter(Boolean),n=e[e.length-1];n&&"webcard"!==n.toLowerCase()&&t(decodeURIComponent(n))},[]),Object(l.jsxs)("div",{className:"bg-gray-900 min-h-screen flex flex-col items-center justify-center text-white font-sans p-4",children:[e?Object(l.jsx)(u,{domain:e,onReset:()=>{t("")}}):Object(l.jsx)(c,{onDomainSubmit:e=>{t(e)}}),Object(l.jsx)("footer",{className:"absolute bottom-4 text-gray-500 text-sm",children:"Built with the assistance of an AI assistant."})]})};var b=e=>{e&&e instanceof Function&&n.e(3).then(n.bind(null,285)).then(t=>{let{getCLS:n,getFID:a,getFCP:r,getLCP:s,getTTFB:o}=t;n(e),a(e),r(e),s(e),o(e)})};o.a.render(Object(l.jsx)(r.a.StrictMode,{children:Object(l.jsx)(m,{})}),document.getElementById("root")),b()}},[[255,1,2]]]);
//# sourceMappingURL=main.fc22b263.chunk.js.map